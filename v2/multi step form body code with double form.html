<!-- Multi Step Form Custom Code -->
<script>
var stepsId = ['step1', 'step2', 'step3']; // PUT HERE ALL YOUR SLIDES (STEPS) ID'S BY ORDER
var numberOfSteps = stepsId.length;
var stepsHeight = [];
var requiredInputs = [];
var Webflow = Webflow || [];

Webflow.push(function () {
	$.each(stepsId, function() {	// Finds all required inputs in each slide and stores them
		var itemId = $(document.getElementById(this));
		var itemHeight = $(itemId).css('height');
  		var inputsArray = [];
		$(itemId).find('input, select, textarea').filter('[required]:visible').each(function() {
			inputsArray.push(this.id);
		});
    	requiredInputs.push(inputsArray);
		stepsHeight.push(itemHeight);
	});
	$('.msf-mask').height(stepsHeight[0]);	// Sets height of mask to fit the 1st slide
});


$('#next').click(function(){
	var currentStep = parseInt($(this).attr('step'));
	var stepIndex = currentStep - 1;
	var filledInputs = 0;

	if (currentStep == numberOfSteps) {	// If last step is detected, submits the form when clicking the button
		$('#msf').submit();
	}
	else {	// Checks if each required input of the step is filled and warns the user when not
		$.each(requiredInputs[stepIndex], function() {
			var itemId = $(document.getElementById(this));
			var itemValue = $(itemId).val();
			var itemConfirmId = $(document.getElementById(this+'-value'));

			if ( !$(itemId).val() ) {
				$(itemId).addClass('warning');
			}
			else {
				$(itemId).removeClass('warning');
				$(itemConfirmId).html(itemValue);	// Sets the value of the input to the correspondant field in the confirm section
				filledInputs++;
			}
		});

		if (requiredInputs[stepIndex].length == filledInputs && $('#consent').is(":checked")) {	// If all the required fields are filled, moves to the next step, and sets the slider height to fit the content
			$('.msf-mask').height(stepsHeight[currentStep]);
			currentStep++;
			$(this).attr('step', currentStep);
			$('#right-arrow').trigger('tap');
			if (currentStep == numberOfSteps) { $(this).html("Submit"); }	// If last step is detected, modifies the button to act as Submit
		}
		else {
			alert("Please, fill all the required fields.");
		}
	}
});


$('#back').click(function(){	// Moves to the previous step and sets the mask height to fit the content
	var currentStep = parseInt($('#next').attr('step'));
	var stepIndex = currentStep - 1;
	$('.msf-mask').height(stepsHeight[stepIndex-1]);
	$('#next').attr('step', stepIndex);
	$('#left-arrow').trigger('tap');
	$('#next').html("Next");
});

// ONLY V2: Submits user info in a secundary hidden form when the users jumps to step 2
$('#right-arrow').one('tap', function(){
	var name = $('#name').val();	// CREATE HERE VARIABLES OF THE FIELDS THAT YOU WANT TO SEND IN THE FIRST STEP
	var email = $('#email').val();
	$('#hidden-name').val(name);	// SET HERE THE ID'S OF THE FIELDS IN THE HIDDEN FORM
	$('#hidden-email').val(email);
	$('#hidden-form').submit();
})
</script>